# Simple VRL test for JSON parsing
if exists(.message) && is_json(string!(.message)) {
    .event.original = del(.message)
    parsed, err = parse_json(string!(.event.original))
    if err == null {
        .event_data = object!(parsed)
    }
}

# Set basic ECS fields
.event.kind = "event"
.event.category = ["unknown"]
.log.format = "json"

# Cleanup
. = compact(., string: true, array: true, object: true, null: true)
